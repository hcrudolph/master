\documentclass[a4paper,12pt,twoside]{report}

\input{preamble.tex}

\begin{document}

%--- Title ---%
\import{}{title.tex}
\pagestyle{empty}
\blankpage

%--- Abstract ---%
\input{abstract.tex}
\blankpage

%--- TOC ---%
\phantomsection
\pagenumbering{arabic}
\pagestyle{plain}
\setcounter{page}{5}
\setcounter{tocdepth}{2}
\tableofcontents

\clearpage

%--- Figures ---%
\listoffigures
\begingroup
\let\clearpage\relax
\vspace{3cm}
\listoftables
\endgroup

%--- Glossary ---%
\printglossary

%--- Acronyms ---%
\printglossary[type=\acronymtype,title=Abbreviations]

%--- Main contents ---%
\chapter{Introduction}
\label{chap:intro}

This thesis is about verifying security properties of the network protocol used for inter-operator communication in 5G systems.
Section \ref{sec:problem} establishes the motivation to research this particular problem.
Section \ref{sec:goal} outlines the research questions in scope and general working assumptions.
Section \ref{sec:related} provides an overview of related work on formal verification of security protocols and mobile network protocols in general.
Section \ref{sec:outline} describes the approach taken to answer the research questions and the overall structure of this thesis.

\section{Context and Problem Statement}
\label{sec:problem}
\import{sections/}{problem.tex}

\section{Aims and Objectives}
\label{sec:goal}
\import{sections/}{goal.tex}

\section{Related Work}
\label{sec:related}
\import{sections/}{related.tex}

\section{Outline}
\label{sec:outline}
\import{sections/}{method.tex}

\clearpage

\chapter{Theoretical Preliminaries}
\label{chap:theory}

Section~\ref{sec:n32} initially describes design rationale and functional requirements on \gls{prins}.
Subsequently, the individual protocol components and message flows are outlined, specifically focussing on security requirements to be verified.
Section~\ref{sec:formal} serves as an introduction to symbolic model checking of security protocols and compares two tools that can be used for this purpose.
Key concepts are explained to an extent that allows the reader to understand the formal model of the \gls{prins} protocol and its verification later on.
Section~\ref{sec:summary} summarizes the theoretical background and draws a conclusion about which tool to use for further analysis.

\section{5G Signaling and the PRINS Protocol}
\label{sec:n32}
\import{sections/}{n32.tex}

\section{Theory of Formal Verification}
\label{sec:formal}
\import{sections/}{formal.tex}

\section{Summary}
\label{sec:summary}
\import{sections/}{summary.tex}

\clearpage

\chapter{Modeling the PRINS Protocol}
\label{chap:modeling}

This chapter expains the \textsc{ProVerif} model of \gls{prins}, design decisions taken during the modelling process, and its limitations.
Section \ref{sec:model} describes the how the individual components of the protocol are represented by \textsc{ProVerif} constructs.
Section \ref{sec:issues} focusses on the assumptions and shortcuts that have been made due to the limitations of formal verification in general or \textsc{ProVerif} specifically.

The code fragments provided in in the remainder of this thesis follow a certain naming convetion.
Variables are written in lowercase with underscores (e.g.  {\sffamily var\_a}).
Global constants are written in uppercase (e.g.  {\sffamily CONST}).
Functions, constructors, destructors, and events are written in camel case (e.g.  {\sffamily sendMsg}).

\section{Model Transposition}
\label{sec:model}
\import{sections/}{model.tex}

\section{Deviations from the Specification}
\label{sec:issues}
\import{sections/}{issues.tex}

\clearpage

\chapter{Verifying the PRINS Protocol}
\label{chap:verification}

The following chapter details the verification performed on the \gls{prins} model described in the preceeding chapter.
Section \ref{sec:verification} describes the formalization of security properties outlined in \ref{ssec:prins-sequence} and the results \textsc{ProVerif} produces.
Section \ref{sec:lessons} describes challenges faced during the verification process and lessons learned.
Section \ref{sec:gaps} summarizes gaps and inconsistencies discovered during modelling and verification of \gls{prins} and what they mean for the security of the protocol.

\section{ProVerif Queries}
\label{sec:verification}
\import{sections/}{verification.tex}

\section{ProVerif Verification Experience}
\label{sec:lessons}
\import{sections/}{lessons.tex}

\section{Specification Gaps}
\label{sec:gaps}
\import{sections/}{gaps.tex}

\clearpage

\chapter{Closing Remarks}
\label{chap:closing}

\section{Conclusion}
\label{sec:conclusion}
\import{sections/}{conclusion.tex}

\section{Future Work}
\label{sec:outlook}
\import{sections/}{outlook.tex}

\clearpage

\printbibliography[title={Literature},heading=bibintoc,nottype=online]

\printbibliography[title={Online Sources},heading=bibintoc,type=online]

\clearpage

%\begin{appendices}

% redefine figure numbering
%\renewcommand\thefigure{\thechapter.\arabic{figure}}

%\chapter{PRINS Protocol Details}

%\input{appendix_a.tex}

%\end{appendices}

\end{document}
